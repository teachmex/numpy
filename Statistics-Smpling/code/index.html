
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.0.2">
    
    
      
        <title>Statistics with sampling - Numpy Tutorials</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.38780c08.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.3f72e892.min.css">
        
      
    
    
    
      
        
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
      
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#satistics-sampling-and-inferences" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../.." title="Numpy Tutorials" class="md-header-nav__button md-logo" aria-label="Numpy Tutorials">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Numpy Tutorials
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Statistics with sampling
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Numpy Tutorials" class="md-nav__button md-logo" aria-label="Numpy Tutorials">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Numpy Tutorials
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Array-Intro/code/" class="md-nav__link">
      Array Introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Arange/code/" class="md-nav__link">
      Arange
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Arange-Oscillation/code/" class="md-nav__link">
      Arange demo with oscillation
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Arange-Wave/code/" class="md-nav__link">
      Arange demo with wave
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Arange-FourierSeries/code/" class="md-nav__link">
      Arange demo with Fourier Series
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Meshgrid/code/" class="md-nav__link">
      Meshgrid Introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Meshgrid-SphericalHrmonics/code/" class="md-nav__link">
      Meshgrid demo with Spherical Harmonics
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Meshgrid-OptimizationExample/code/" class="md-nav__link">
      Meshgrid demo with Optimization
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Meshgrid-SimulationExample/code/" class="md-nav__link">
      Meshgrid demo with Simulation
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Algebra/code/" class="md-nav__link">
      Algebra
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Algebra-QuantumMechanics/" class="md-nav__link">
      Algebra with Quantum Mechanics
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Algebra-CompositeHamiltonian/code/" class="md-nav__link">
      Algebra with Composite Hamiltonian
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Statistics/" class="md-nav__link">
      Statistics
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Statistics-Probability/code/" class="md-nav__link">
      Statistics with Probability
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Statistics with sampling
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" class="md-nav__link md-nav__link--active">
      Statistics with sampling
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#satistics-sampling-and-inferences" class="md-nav__link">
    Satistics : Sampling and Inferences
  </a>
  
    <nav class="md-nav" aria-label="Satistics : Sampling and Inferences">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sampling-with-montecarlo" class="md-nav__link">
    Sampling with Montecarlo
  </a>
  
    <nav class="md-nav" aria-label="Sampling with Montecarlo">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-montecarlo-integration" class="md-nav__link">
    1.  Montecarlo Integration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-markov-chain-montecarlo" class="md-nav__link">
    2. Markov Chain Montecarlo
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-gibbs-sampling" class="md-nav__link">
    3. Gibb's Sampling
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-metropolice-hasting" class="md-nav__link">
    4. Metropolice Hasting
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#satistics-sampling-and-inferences" class="md-nav__link">
    Satistics : Sampling and Inferences
  </a>
  
    <nav class="md-nav" aria-label="Satistics : Sampling and Inferences">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sampling-with-montecarlo" class="md-nav__link">
    Sampling with Montecarlo
  </a>
  
    <nav class="md-nav" aria-label="Sampling with Montecarlo">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-montecarlo-integration" class="md-nav__link">
    1.  Montecarlo Integration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-markov-chain-montecarlo" class="md-nav__link">
    2. Markov Chain Montecarlo
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-gibbs-sampling" class="md-nav__link">
    3. Gibb's Sampling
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-metropolice-hasting" class="md-nav__link">
    4. Metropolice Hasting
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Statistics with sampling</h1>
                
                <h2 id="satistics-sampling-and-inferences">Satistics : Sampling and Inferences</h2>
<p>https://docs.scipy.org/doc/scipy/reference/stats.html</p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code><span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">numpy</span> <span style="color: #006699; font-weight: bold">as</span> <span style="color: #00CCFF; font-weight: bold">np</span>
<span style="color: #006699; font-weight: bold">from</span> <span style="color: #00CCFF; font-weight: bold">scipy</span> <span style="color: #006699; font-weight: bold">import</span> stats
<span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">matplotlib.pyplot</span> <span style="color: #006699; font-weight: bold">as</span> <span style="color: #00CCFF; font-weight: bold">plt</span>
<span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">seaborn</span> <span style="color: #006699; font-weight: bold">as</span> <span style="color: #00CCFF; font-weight: bold">sns</span>
sns<span style="color: #555555">.</span>set()
</code></pre></div>


<h3 id="sampling-with-montecarlo">Sampling with Montecarlo</h3>
<h4 id="1-montecarlo-integration">1.  Montecarlo Integration</h4>
<ul>
<li>Example 1</li>
</ul>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>np<span style="color: #555555">.</span>arange(<span style="color: #555555">-</span><span style="color: #FF6600">3</span>,<span style="color: #FF6600">3</span>,<span style="color: #FF6600">0.01</span>)
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>x <span style="color: #555555">=</span> np<span style="color: #555555">.</span>linspace(<span style="color: #555555">-</span><span style="color: #FF6600">3</span>,<span style="color: #FF6600">3</span>,<span style="color: #FF6600">100</span>)
dist <span style="color: #555555">=</span> stats<span style="color: #555555">.</span>norm(<span style="color: #FF6600">0</span>,<span style="color: #FF6600">1</span>)
a <span style="color: #555555">=</span> <span style="color: #555555">-</span><span style="color: #FF6600">2</span>
b <span style="color: #555555">=</span> <span style="color: #FF6600">0</span>
plt<span style="color: #555555">.</span>plot(x, dist<span style="color: #555555">.</span>pdf(x))
plt<span style="color: #555555">.</span>fill_between(np<span style="color: #555555">.</span>linspace(a,b,<span style="color: #FF6600">100</span>), dist<span style="color: #555555">.</span>pdf(np<span style="color: #555555">.</span>linspace(a,b,<span style="color: #FF6600">100</span>)), alpha<span style="color: #555555">=</span><span style="color: #FF6600">0.5</span>)
plt<span style="color: #555555">.</span>text(b<span style="color: #555555">+</span><span style="color: #FF6600">0.1</span>, <span style="color: #FF6600">0.1</span>, <span style="color: #CC3300">&#39;p=</span><span style="color: #AA0000">%.4f</span><span style="color: #CC3300">&#39;</span> <span style="color: #555555">%</span> (dist<span style="color: #555555">.</span>cdf(b) <span style="color: #555555">-</span> dist<span style="color: #555555">.</span>cdf(a)), fontsize<span style="color: #555555">=</span><span style="color: #FF6600">14</span>)
<span style="color: #006699; font-weight: bold">pass</span>
</code></pre></div>


<p><img alt="png" src="../output_7_0.png" /></p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>n <span style="color: #555555">=</span> <span style="color: #FF6600">10000</span>
x <span style="color: #555555">=</span> stats<span style="color: #555555">.</span>norm<span style="color: #555555">.</span>rvs(loc<span style="color: #555555">=</span><span style="color: #FF6600">0</span>,scale<span style="color: #555555">=</span><span style="color: #FF6600">1</span>,size<span style="color: #555555">=</span>n)
</code></pre></div>


<p>These points are generated randomly. No dependence to each other.</p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>plt<span style="color: #555555">.</span>figure(figsize <span style="color: #555555">=</span> [<span style="color: #FF6600">18</span>,<span style="color: #FF6600">4</span>])
plt<span style="color: #555555">.</span>plot(<span style="color: #336666">range</span>(<span style="color: #336666">len</span>(x[<span style="color: #FF6600">0</span>:<span style="color: #FF6600">100</span>])),x[<span style="color: #FF6600">0</span>:<span style="color: #FF6600">100</span>])
plt<span style="color: #555555">.</span>scatter(<span style="color: #336666">range</span>(<span style="color: #336666">len</span>(x[<span style="color: #FF6600">0</span>:<span style="color: #FF6600">100</span>])),x[<span style="color: #FF6600">0</span>:<span style="color: #FF6600">100</span>])
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>&lt;matplotlib.collections.PathCollection at 0x1b34b5e8a58&gt;
</code></pre></div>


<p><img alt="png" src="../output_10_1.png" /></p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>np<span style="color: #555555">.</span>sum((a <span style="color: #555555">&lt;</span> x) <span style="color: #555555">&amp;</span> (x <span style="color: #555555">&lt;</span> b))<span style="color: #555555">/</span>n
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>0.4733
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code><span style="color: #006699; font-weight: bold">from</span> <span style="color: #00CCFF; font-weight: bold">scipy.integrate</span> <span style="color: #006699; font-weight: bold">import</span> quad
y, err <span style="color: #555555">=</span> quad(dist<span style="color: #555555">.</span>pdf, a, b)
y
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>0.47724986805182085
</code></pre></div>


<h4 id="2-markov-chain-montecarlo">2. Markov Chain Montecarlo</h4>
<p>In statistics, Markov chain Monte Carlo (MCMC) methods comprise a class of algorithms for sampling from a probability distribution. By constructing a Markov chain that has the desired distribution as its equilibrium distribution, one can obtain a sample of the desired distribution by recording states from the chain. The more steps that are included, the more closely the distribution of the sample matches the actual desired distribution. Various algorithms exist for constructing chains, including the Metropolis–Hastings algorithm.</p>
<p>All MCMC sampling schemes have the following structure:</p>
<p>Start with some state xk</p>
<p>Repeat</p>
<ul>
<li>Draw a sample xk+1 from a proposal distribution p(xk)</li>
<li>Calculate the acceptance probability A(x) - in general, this is a function of the proposal and target distributions at xk and xk+1</li>
<li>Choose a standard random uniform number r</li>
<li>If r&lt;A(x) set state to be xk+1, otherwise keep state as xk</li>
</ul>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>n <span style="color: #555555">=</span> <span style="color: #FF6600">10000</span>
xs <span style="color: #555555">=</span> np<span style="color: #555555">.</span>zeros(n)
x <span style="color: #555555">=</span> <span style="color: #FF6600">0</span>
<span style="color: #006699; font-weight: bold">for</span> i <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(n):
    p <span style="color: #555555">=</span> np<span style="color: #555555">.</span>random<span style="color: #555555">.</span>uniform(x<span style="color: #555555">-</span><span style="color: #FF6600">1</span>, x<span style="color: #555555">+</span><span style="color: #FF6600">1</span>)
    a <span style="color: #555555">=</span> np<span style="color: #555555">.</span>exp(<span style="color: #555555">-</span>(p<span style="color: #555555">**</span><span style="color: #FF6600">2</span><span style="color: #555555">-</span>x<span style="color: #555555">**</span><span style="color: #FF6600">2</span>)<span style="color: #555555">/</span><span style="color: #FF6600">2</span>)
    r <span style="color: #555555">=</span> np<span style="color: #555555">.</span>random<span style="color: #555555">.</span>rand()
    <span style="color: #006699; font-weight: bold">if</span> r <span style="color: #555555">&lt;</span> a:
        x <span style="color: #555555">=</span> p
    xs[i] <span style="color: #555555">=</span> x
</code></pre></div>


<p>These data points create a chain call Markov Chain. The sample generation follows principle of detailed balance.</p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>plt<span style="color: #555555">.</span>figure(figsize <span style="color: #555555">=</span> [<span style="color: #FF6600">18</span>,<span style="color: #FF6600">4</span>])
plt<span style="color: #555555">.</span>plot(<span style="color: #336666">range</span>(<span style="color: #336666">len</span>(xs[<span style="color: #FF6600">0</span>:<span style="color: #FF6600">100</span>])),xs[<span style="color: #FF6600">0</span>:<span style="color: #FF6600">100</span>])
plt<span style="color: #555555">.</span>scatter(<span style="color: #336666">range</span>(<span style="color: #336666">len</span>(xs[<span style="color: #FF6600">0</span>:<span style="color: #FF6600">100</span>])),xs[<span style="color: #FF6600">0</span>:<span style="color: #FF6600">100</span>])
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>&lt;matplotlib.collections.PathCollection at 0x1b34b63fd30&gt;
</code></pre></div>


<p><img alt="png" src="../output_17_1.png" /></p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>plt<span style="color: #555555">.</span>hist(xs, <span style="color: #FF6600">25</span>, histtype<span style="color: #555555">=</span><span style="color: #CC3300">&#39;step&#39;</span>, density<span style="color: #555555">=</span><span style="color: #006699; font-weight: bold">True</span>)
xp <span style="color: #555555">=</span> np<span style="color: #555555">.</span>linspace(xs<span style="color: #555555">.</span>min(), xs<span style="color: #555555">.</span>max(), <span style="color: #FF6600">100</span>)
plt<span style="color: #555555">.</span>plot(xp, stats<span style="color: #555555">.</span>norm()<span style="color: #555555">.</span>pdf(xp))
<span style="color: #006699; font-weight: bold">pass</span>
</code></pre></div>


<p><img alt="png" src="../output_18_0.png" /></p>
<h4 id="3-gibbs-sampling">3. Gibb's Sampling</h4>
<p>In statistics, Gibbs sampling or a Gibbs sampler is a Markov chain Monte Carlo (MCMC) algorithm for obtaining a sequence of observations which are approximated from a specified multivariate probability distribution, when direct sampling is difficult.</p>
<p>Gibbs sampling is a type of random walk through parameter space.</p>
<p>Suppose the parameter vector $\theta$ has two components $\theta= [\theta_1, \theta_2]$, then each iteration of the Gibbs sampler cycles through each component and draws a new value conditional on all the others. There are thus 2 steps for each iteration. We consider the example of the bivariate normal distribution with unknown mean $\theta$, but known covariance matrix</p>
<p>$$\left(\begin{array}{cc}1 &amp; \rho \\ \rho &amp; 1 \end{array}\right).$$
If one observation $X=[x_1, x_2]$ is made and a uniform prior on $\theta$ is used, the posterior is given by</p>
<p>$$ \left(\begin{array}{c} \theta_1 \\ \theta_2 \end{array}\right) \biggr\rvert X \sim N\left(\left(\begin{array}{c}x_1 \\ x_2 \end{array}\right), \left(\begin{array}{cc}1 &amp; \rho \\ \rho &amp; 1 \end{array}\right)\right) $$</p>
<p>In order to illustrate the use of the Gibbs sampler we need the conditional posterior distributions, which from the properties of multivariate normal distributions are given by</p>
<p>$$\theta_1|\theta_2,\: x_1 \text{ ~ } N(\rho\theta_2,\: 1-\rho^2) \text{ ~ } \rho\theta_2 + \sqrt{1-\rho^2}N(0,\:1)$$
$$\theta_2|\theta_1,\: x_2 \text{ ~ } N(\rho\theta_1,\: 1-\rho^2) \text{ ~ } \rho\theta_1 + \sqrt{1-\rho^2}N(0,\:1)$$</p>
<p>The Gibbs sampler proceeds by alternately sampling from these two normal distributions. This is now coded in simple Python deliberately making the steps obvious.</p>
<ul>
<li>Experiemnt -1 (Flat distribution)</li>
</ul>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code><span style="color: #CC3300; font-style: italic">&#39;&#39;&#39;sampling&#39;&#39;&#39;</span>
rho <span style="color: #555555">=</span> <span style="color: #555555">-</span><span style="color: #FF6600">0.45</span>
niter <span style="color: #555555">=</span> <span style="color: #FF6600">1000</span>
xs <span style="color: #555555">=</span> np<span style="color: #555555">.</span>zeros((niter, <span style="color: #FF6600">2</span>))

x1,x2<span style="color: #555555">=</span><span style="color: #FF6600">0</span>,<span style="color: #FF6600">0</span>
xs[<span style="color: #FF6600">0</span>,:] <span style="color: #555555">=</span> x1,x2

<span style="color: #006699; font-weight: bold">for</span> i <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">1</span>,niter):
    x1 <span style="color: #555555">=</span> np<span style="color: #555555">.</span>random<span style="color: #555555">.</span>normal(rho<span style="color: #555555">*</span>x2, <span style="color: #FF6600">1</span><span style="color: #555555">-</span>rho<span style="color: #555555">**</span><span style="color: #FF6600">2</span>)
    x2 <span style="color: #555555">=</span> np<span style="color: #555555">.</span>random<span style="color: #555555">.</span>normal(rho<span style="color: #555555">*</span>x1, <span style="color: #FF6600">1</span><span style="color: #555555">-</span>rho<span style="color: #555555">**</span><span style="color: #FF6600">2</span>)
    xs[i,:] <span style="color: #555555">=</span> x1,x2

<span style="color: #CC3300; font-style: italic">&#39;&#39;&#39;contor&#39;&#39;&#39;</span>
dist <span style="color: #555555">=</span> stats<span style="color: #555555">.</span>multivariate_normal([<span style="color: #FF6600">0</span>,<span style="color: #FF6600">0</span>], np<span style="color: #555555">.</span>array([[<span style="color: #FF6600">1</span>,rho],[rho,<span style="color: #FF6600">1</span>]]))
x <span style="color: #555555">=</span> np<span style="color: #555555">.</span>linspace(<span style="color: #555555">-</span><span style="color: #FF6600">3.0</span>, <span style="color: #FF6600">3.0</span>, <span style="color: #FF6600">100</span>)
y <span style="color: #555555">=</span> np<span style="color: #555555">.</span>linspace(<span style="color: #555555">-</span><span style="color: #FF6600">3.0</span>, <span style="color: #FF6600">2.0</span>, <span style="color: #FF6600">100</span>)
X, Y <span style="color: #555555">=</span> np<span style="color: #555555">.</span>meshgrid(x, y)
Z <span style="color: #555555">=</span> dist<span style="color: #555555">.</span>pdf(np<span style="color: #555555">.</span>c_[X<span style="color: #555555">.</span>ravel(), Y<span style="color: #555555">.</span>ravel()])<span style="color: #555555">.</span>reshape(X<span style="color: #555555">.</span>shape)

<span style="color: #CC3300; font-style: italic">&#39;&#39;&#39;plot&#39;&#39;&#39;</span>
plt<span style="color: #555555">.</span>figure(figsize <span style="color: #555555">=</span> [<span style="color: #FF6600">18</span>,<span style="color: #FF6600">10</span>])
plt<span style="color: #555555">.</span>contour(X, Y, Z)
plt<span style="color: #555555">.</span>scatter(xs[:, <span style="color: #FF6600">0</span>], xs[:, <span style="color: #FF6600">1</span>], s<span style="color: #555555">=</span><span style="color: #FF6600">2</span>)
plt<span style="color: #555555">.</span>plot(xs[:, <span style="color: #FF6600">0</span>], xs[:, <span style="color: #FF6600">1</span>],alpha <span style="color: #555555">=</span> <span style="color: #FF6600">0.1</span>)
plt<span style="color: #555555">.</span>axis(<span style="color: #CC3300">&#39;square&#39;</span>)
plt<span style="color: #555555">.</span>show()
</code></pre></div>


<p><img alt="png" src="../output_22_0.png" /></p>
<ul>
<li>Experiment -2 (Narrow distribution)</li>
</ul>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code><span style="color: #CC3300; font-style: italic">&#39;&#39;&#39;sampling&#39;&#39;&#39;</span>
rho <span style="color: #555555">=</span> <span style="color: #555555">-</span><span style="color: #FF6600">0.8</span>
niter <span style="color: #555555">=</span> <span style="color: #FF6600">10</span>
xs <span style="color: #555555">=</span> np<span style="color: #555555">.</span>zeros((niter, <span style="color: #FF6600">2</span>))

x1,x2<span style="color: #555555">=</span><span style="color: #FF6600">0</span>,<span style="color: #FF6600">0</span>
xs[<span style="color: #FF6600">0</span>,:] <span style="color: #555555">=</span> x1,x2

<span style="color: #006699; font-weight: bold">for</span> i <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">1</span>,niter):
    x1 <span style="color: #555555">=</span> np<span style="color: #555555">.</span>random<span style="color: #555555">.</span>normal(rho<span style="color: #555555">*</span>x2, <span style="color: #FF6600">1</span><span style="color: #555555">-</span>rho<span style="color: #555555">**</span><span style="color: #FF6600">2</span>)
    x2 <span style="color: #555555">=</span> np<span style="color: #555555">.</span>random<span style="color: #555555">.</span>normal(rho<span style="color: #555555">*</span>x1, <span style="color: #FF6600">1</span><span style="color: #555555">-</span>rho<span style="color: #555555">**</span><span style="color: #FF6600">2</span>)
    xs[i,:] <span style="color: #555555">=</span> x1,x2

<span style="color: #CC3300; font-style: italic">&#39;&#39;&#39;contor&#39;&#39;&#39;</span>
dist <span style="color: #555555">=</span> stats<span style="color: #555555">.</span>multivariate_normal([<span style="color: #FF6600">0</span>,<span style="color: #FF6600">0</span>], np<span style="color: #555555">.</span>array([[<span style="color: #FF6600">1</span>,rho],[rho,<span style="color: #FF6600">1</span>]]))
x <span style="color: #555555">=</span> np<span style="color: #555555">.</span>linspace(<span style="color: #555555">-</span><span style="color: #FF6600">3.0</span>, <span style="color: #FF6600">3.0</span>, <span style="color: #FF6600">100</span>)
y <span style="color: #555555">=</span> np<span style="color: #555555">.</span>linspace(<span style="color: #555555">-</span><span style="color: #FF6600">3.0</span>, <span style="color: #FF6600">2.0</span>, <span style="color: #FF6600">100</span>)
X, Y <span style="color: #555555">=</span> np<span style="color: #555555">.</span>meshgrid(x, y)
Z <span style="color: #555555">=</span> dist<span style="color: #555555">.</span>pdf(np<span style="color: #555555">.</span>c_[X<span style="color: #555555">.</span>ravel(), Y<span style="color: #555555">.</span>ravel()])<span style="color: #555555">.</span>reshape(X<span style="color: #555555">.</span>shape)

<span style="color: #CC3300; font-style: italic">&#39;&#39;&#39;plot&#39;&#39;&#39;</span>
plt<span style="color: #555555">.</span>figure(figsize <span style="color: #555555">=</span> [<span style="color: #FF6600">18</span>,<span style="color: #FF6600">10</span>])
plt<span style="color: #555555">.</span>contour(X, Y, Z)
plt<span style="color: #555555">.</span>scatter(xs[:, <span style="color: #FF6600">0</span>], xs[:, <span style="color: #FF6600">1</span>], s<span style="color: #555555">=</span><span style="color: #FF6600">2</span>)
plt<span style="color: #555555">.</span>plot(xs[:, <span style="color: #FF6600">0</span>], xs[:, <span style="color: #FF6600">1</span>],alpha <span style="color: #555555">=</span> <span style="color: #FF6600">0.5</span>)
plt<span style="color: #555555">.</span>axis(<span style="color: #CC3300">&#39;square&#39;</span>)
plt<span style="color: #555555">.</span>show()
</code></pre></div>


<p><img alt="png" src="../output_24_0.png" /></p>
<h4 id="4-metropolice-hasting">4. <a href="https://wiseodd.github.io/techblog/2015/10/17/metropolis-hastings/">Metropolice Hasting</a></h4>
<p>In statistics and statistical physics, the Metropolis–Hastings algorithm is a Markov chain Monte Carlo (MCMC) method for obtaining a sequence of random samples from a probability distribution from which direct sampling is difficult.</p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code><span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">circle</span>(x, y):
    <span style="color: #006699; font-weight: bold">return</span> (x<span style="color: #555555">-</span><span style="color: #FF6600">1</span>)<span style="color: #555555">**</span><span style="color: #FF6600">2</span> <span style="color: #555555">+</span> (y<span style="color: #555555">-</span><span style="color: #FF6600">2</span>)<span style="color: #555555">**</span><span style="color: #FF6600">2</span> <span style="color: #555555">-</span> <span style="color: #FF6600">3</span><span style="color: #555555">**</span><span style="color: #FF6600">2</span>

<span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">pgauss</span>(x, y):
    <span style="color: #006699; font-weight: bold">return</span> stats<span style="color: #555555">.</span>multivariate_normal<span style="color: #555555">.</span>pdf([x, y], mean<span style="color: #555555">=</span>mus, cov<span style="color: #555555">=</span>sigmas)
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code><span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">metropolis_hastings</span>(p, <span style="color: #336666">iter</span><span style="color: #555555">=</span><span style="color: #FF6600">1000</span>):
    x, y <span style="color: #555555">=</span> <span style="color: #FF6600">0.</span>, <span style="color: #FF6600">0.</span>
    samples <span style="color: #555555">=</span> np<span style="color: #555555">.</span>zeros((<span style="color: #336666">iter</span>, <span style="color: #FF6600">2</span>))

    <span style="color: #006699; font-weight: bold">for</span> i <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #336666">iter</span>):
        x_star, y_star <span style="color: #555555">=</span> np<span style="color: #555555">.</span>array([x, y]) <span style="color: #555555">+</span> np<span style="color: #555555">.</span>random<span style="color: #555555">.</span>normal(size<span style="color: #555555">=</span><span style="color: #FF6600">2</span>)

        frac <span style="color: #555555">=</span> p(x_star, y_star)<span style="color: #555555">/</span>p(x, y)

        <span style="color: #006699; font-weight: bold">if</span> np<span style="color: #555555">.</span>random<span style="color: #555555">.</span>rand() <span style="color: #555555">&lt;</span> frac:
            x, y <span style="color: #555555">=</span> x_star, y_star
        samples[i] <span style="color: #555555">=</span> np<span style="color: #555555">.</span>array([x, y])

    <span style="color: #006699; font-weight: bold">return</span> samples
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>mus <span style="color: #555555">=</span> np<span style="color: #555555">.</span>array([<span style="color: #FF6600">5</span>, <span style="color: #FF6600">5</span>])
sigmas <span style="color: #555555">=</span> np<span style="color: #555555">.</span>array([[<span style="color: #FF6600">1</span>, <span style="color: #555555">.</span><span style="color: #FF6600">9</span>], [<span style="color: #555555">.</span><span style="color: #FF6600">9</span>, <span style="color: #FF6600">1</span>]])
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>samples <span style="color: #555555">=</span> metropolis_hastings(circle, <span style="color: #336666">iter</span><span style="color: #555555">=</span><span style="color: #FF6600">10000</span>)
sns<span style="color: #555555">.</span>jointplot(samples[:, <span style="color: #FF6600">0</span>], samples[:, <span style="color: #FF6600">1</span>])
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>&lt;seaborn.axisgrid.JointGrid at 0x1b34b7a46d8&gt;
</code></pre></div>


<p><img alt="png" src="../output_29_1.png" /></p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>samples <span style="color: #555555">=</span> metropolis_hastings(pgauss, <span style="color: #336666">iter</span><span style="color: #555555">=</span><span style="color: #FF6600">10000</span>)
sns<span style="color: #555555">.</span>jointplot(samples[:, <span style="color: #FF6600">0</span>], samples[:, <span style="color: #FF6600">1</span>])
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>&lt;seaborn.axisgrid.JointGrid at 0x1b34b838828&gt;
</code></pre></div>


<p><img alt="png" src="../output_30_1.png" /></p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../../Statistics-Probability/code/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Statistics with Probability
              </div>
            </div>
          </a>
        
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.77e55a48.min.js"></script>
      <script src="../../assets/javascripts/bundle.9554a270.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
    
  </body>
</html>